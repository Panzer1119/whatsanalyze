{"version":3,"sources":["webpack:///./functions/gtagValues.js","webpack:///./components/FileHandler.vue?b3a8","webpack:///./assets/loader.svg","webpack:///./components/FileHandler.vue?2397","webpack:///./components/FileHandler.vue?0923","webpack:///./components/FileHandler.vue?0c79","webpack:///./components/FileHandler.vue?b1a4","webpack:///./components/FileHandler.vue","webpack:///./components/FileHandler.vue?6e83"],"names":["CATEGORY_HOME","GTAG_FILE","GTAG_RESULTS","GTAG_PDF","GTAG_PAYMENT","GTAG_INSTALL","GTAG_LEAD","GTAG_INTERACTION","GTAG_NUM_PERSONS","gtagEvent","action","label","value","window","$nuxt","$gtag","event","event_category","event_label","String","content","__esModule","default","module","i","locals","exports","add","___CSS_LOADER_EXPORT___","___CSS_LOADER_API_IMPORT___","push","name","data","isDragging","wrongFile","processing","isSuccess","attachments","methods","extendDataStructure","chatObject","authors","messages","forEach","object","index","author","absolute_id","personal_id","zipLoadEndHandler","e","arrayBuffer","target","result","JSZip","loadAsync","then","zipData","chatFile","getChatFile","parseString","parseAttachments","this","updateMessages","file","async","sort","a","b","length","readSharedFiles","files","chatRegex","RegExp","find","test","findChatFile","Array","from","undefined","reader","FileReader","addEventListener","loadedFile","_fileName","Promise","resolve","readAsText","showErrorMessage","txtLoadEndHandler","$emit","text","processFileList","fileList","shared","type","readAsArrayBuffer","dragOver","dragLeave","drop","dataTransfer","requestUploadFile","$el","querySelector","component","_vm","_h","$createElement","_c","_self","staticClass","on","$event","preventDefault","apply","arguments","attrs","_v","staticStyle","class","smallFont","$vuetify","breakpoint","smAndDown","directives","rawName","expression","_s","$t","domProps","_e","VIcon"],"mappings":"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","file":"085b9ff.js","sourcesContent":["export const CATEGORY_HOME = \"home\";\n\nexport const GTAG_FILE = \"file\";\nexport const GTAG_RESULTS = \"results\";\nexport const GTAG_PDF = \"pdf\";\nexport const GTAG_PAYMENT = \"payment\";\nexport const GTAG_INSTALL = \"install\";\nexport const GTAG_LEAD = \"lead\";\nexport const GTAG_INTERACTION = \"interaction\";\nexport const GTAG_NUM_PERSONS = \"num_persons\";\n\nexport function gtagEvent(action, label, value = \"1\") {\n  window.$nuxt.$gtag.event(label + \"_\" + action, {\n    event_category: CATEGORY_HOME,\n    event_label: label,\n    value: String(value),\n  });\n}\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileHandler.vue?vue&type=style&index=0&id=f2c8d122&scoped=true&lang=scss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"44b43010\", content, true, {\"sourceMap\":false});","module.exports = __webpack_public_path__ + \"img/loader.e6dfbd0.svg\";","export * from \"-!../node_modules/vue-style-loader/index.js??ref--7-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileHandler.vue?vue&type=style&index=0&id=f2c8d122&scoped=true&lang=scss&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(false);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".top-color[data-v-f2c8d122]{background-color:#21a68d}.only-visible-to-html2canvas[data-v-f2c8d122]{display:none}.cta[data-v-f2c8d122]{background:#f2f2f2}.link[data-v-f2c8d122]{border:none;font-family:arial,sans-serif;color:#069;text-decoration:underline;cursor:pointer}.w-100[data-v-f2c8d122]{width:100%}.smallFont p[data-v-f2c8d122]{font-size:1.1em!important}.drop-container[data-v-f2c8d122]{text-align:center;background:#21a68d}.drop[data-v-f2c8d122]{display:flex;align-items:center;justify-items:center;min-height:150px;border:2px dashed #022e40;border-radius:20px;-webkit-animation-name:attention-data-v-f2c8d122;animation-name:attention-data-v-f2c8d122;-webkit-animation-duration:2s;animation-duration:2s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite}@-webkit-keyframes attention-data-v-f2c8d122{0%{box-shadow:2px 2px 20px #000}50%{box-shadow:none}to{box-shadow:2px 2px 20px #000}}@keyframes attention-data-v-f2c8d122{0%{box-shadow:2px 2px 20px #000}50%{box-shadow:none}to{box-shadow:2px 2px 20px #000}}textarea[data-v-f2c8d122]{width:100%;height:100%;-o-object-fit:contain;object-fit:contain;resize:none}input[type=file][data-v-f2c8d122]{display:none}.isDragging[data-v-f2c8d122]{box-shadow:0 0 40px #000!important;border-style:solid;background:#022e40;text-shadow:#7fff00;color:#21a68d!important}.isSuccess[data-v-f2c8d122]{-webkit-animation-name:done-data-v-f2c8d122;animation-name:done-data-v-f2c8d122;-webkit-animation-duration:2s;animation-duration:2s;-webkit-animation-iteration-count:1;animation-iteration-count:1}@-webkit-keyframes done-data-v-f2c8d122{0%{background:#21a68d}50%{background:#adff2f}to{background:#21a68d}}@keyframes done-data-v-f2c8d122{0%{background:#21a68d}50%{background:#adff2f}to{background:#21a68d}}\", \"\"]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"drop-container pa-md-0\",on:{\"dragover\":function($event){$event.preventDefault();return _vm.dragOver.apply(null, arguments)},\"dragleave\":function($event){$event.preventDefault();return _vm.dragLeave.apply(null, arguments)},\"drop\":function($event){$event.preventDefault();return _vm.drop($event)}}},[_c('v-icon',{staticClass:\"py-2\",attrs:{\"size\":\"50\",\"color\":\"rgba(0,0,0,0.8)\"}},[_vm._v(\"\\n    mdi-chevron-down\\n  \")]),_vm._v(\" \"),_c('label',{staticStyle:{\"cursor\":\"pointer\"},attrs:{\"for\":\"uploadmytextfile\"}},[_c('div',{staticClass:\"drop pa-3\",class:{\n        isDragging: _vm.isDragging,\n        smallFont: _vm.$vuetify.breakpoint.smAndDown,\n        isSuccess: _vm.isSuccess,\n      }},[_c('input',{attrs:{\"type\":\"file\",\"multiple\":\"\",\"id\":\"uploadmytextfile\"},on:{\"change\":_vm.requestUploadFile}}),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.wrongFile),expression:\"wrongFile\"}],staticClass:\"text-body-1 text-md-h5 w-100\"},[_vm._v(\"\\n        \"+_vm._s(_vm.$t(\"fileWrong\"))+\"\\n      \")]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isDragging),expression:\"isDragging\"}],staticClass:\"text-h4 py-2 w-100\"},[_c('br'),_vm._v(\"\\n        \"+_vm._s(_vm.$t(\"fileDrop\"))+\"\\n      \")]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isDragging && !_vm.wrongFile && !_vm.processing),expression:\"!isDragging && !wrongFile && !processing\"}],staticClass:\"text-body-1 text-md-h5 w-100\"},[_c('v-icon',{attrs:{\"size\":\"2em\"}},[_vm._v(\" mdi-file \")]),_vm._v(\" \"),_c('br'),_vm._v(\" \"),(_vm.isSuccess)?_c('div',{domProps:{\"innerHTML\":_vm._s(_vm.$t('fileDone'))}}):_vm._e(),_vm._v(\" \"),_c('div',{class:{ 'text-caption': _vm.isSuccess }},[(_vm.$vuetify.breakpoint.mdAndUp)?_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.$t('fileSuccess'))}}):_vm._e(),_vm._v(\" \"),(_vm.$vuetify.breakpoint.smAndDown)?_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.$t('fileSelect'))}}):_vm._e(),_vm._v(\" \"),(_vm.isSuccess)?_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.$t('fileAnother'))}}):_vm._e(),_vm._v(\" \"),(!_vm.isSuccess)?_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.$t('fileZip'))}}):_vm._e()])],1),_vm._v(\" \"),_c('br'),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.processing),expression:\"processing\"}],staticClass:\"text-body-1 text-md-h5 w-100\"},[_c('img',{attrs:{\"src\":require(\"@/assets/loader.svg\"),\"height\":\"40\",\"width\":\"40\"}}),_vm._v(\" \"),_c('br'),_vm._v(\" \"),_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.$t('fileProcessing'))}})])])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileHandler.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileHandler.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { parseString } from \"whatsapp-chat-parser\";\nimport JSZip from \"jszip\";\nimport { gtagEvent, GTAG_FILE } from \"~/functions/gtagValues\";\n\nexport default {\n  name: \"FileHandler\",\n  data() {\n    return {\n      isDragging: false,\n      wrongFile: false,\n      processing: false,\n      isSuccess: false,\n      attachments: {},\n    };\n  },\n  methods: {\n    extendDataStructure(chatObject) {\n      let authors = {};\n      chatObject.messages.forEach(function (object, index) {\n        if (!(object.author in authors)) authors[object.author] = 0;\n        else authors[object.author] += 1;\n        object.absolute_id = index;\n        object.personal_id = authors[object.author];\n      });\n    },\n\n    zipLoadEndHandler(e) {\n      const arrayBuffer = e.target.result;\n      const jszip = new JSZip();\n      const zip = jszip.loadAsync(arrayBuffer);\n\n      zip\n        .then((zipData) => {\n          let chatFile = this.getChatFile(zipData);\n          return parseString(chatFile, {\n            parseAttachments: true,\n          }).then((messages) => {\n            return {\n              messages: messages,\n              attachments: zipData,\n            };\n          });\n        })\n        .then(this.updateMessages);\n    },\n\n    async getChatFile(zipData) {\n      // this is the standard file on ios, if found return\n      const chatFile = zipData.file(\"_chat.txt\");\n      if (chatFile) return chatFile.async(\"string\");\n\n      // otherwise search for potential other txt files\n      // take shortes one\n      return await zipData\n        .file(/.*(?:chat|whatsapp).*\\.txt$/i)\n        .sort((a, b) => a.name.length - b.name.length)[0]\n        .async(\"string\");\n    },\n\n    readSharedFiles(files) {\n      function findChatFile(files) {\n        let chatRegex = new RegExp(/.*(?:chat|whatsapp).*\\.txt$/i);\n        return files.find((file) => {\n          return chatRegex.test(file.name);\n        });\n      }\n\n      files = Array.from(files);\n      let chatFile = findChatFile(files);\n      if (chatFile === undefined) {\n        this.showErrorMessage();\n        return;\n      }\n      const reader = new FileReader();\n      reader.addEventListener(\"loadend\", (loadedFile) => {\n        parseString(loadedFile.target.result, {\n          parseAttachments: true,\n        }).then((messages) => {\n          this.updateMessages({\n            messages: messages,\n            attachments: {\n              files: files,\n              file(_fileName) {\n                return {\n                  async: () =>\n                    Promise.resolve(\n                      this.files.find((file) => file.name === _fileName)\n                    ),\n                };\n              },\n            },\n          });\n        });\n      });\n      reader.readAsText(chatFile);\n    },\n\n    txtLoadEndHandler(e) {\n      parseString(e.target.result).then((messages) =>\n        this.updateMessages({ messages: messages })\n      );\n    },\n\n    updateMessages(chatObject) {\n      this.extendDataStructure(chatObject);\n      this.$emit(\"new_messages\", chatObject);\n      this.$emit(\"hide_explanation\", true);\n      this.processing = false;\n      this.isSuccess = true;\n      gtagEvent(\"parsed\", GTAG_FILE);\n    },\n\n    showErrorMessage(text = undefined) {\n      this.wrongFile = true;\n      this.processing = false;\n      this.isSuccess = false;\n      gtagEvent(\"error\" + (text || \"\"), GTAG_FILE, 0);\n    },\n    processFileList(fileList, shared = false) {\n      this.isDragging = false;\n      this.processing = true;\n      this.isSuccess = false;\n      this.wrongFile = false;\n\n      if (shared || fileList.length > 1) {\n        //do multiple here\n        this.readSharedFiles(fileList);\n      } else {\n        let file = fileList[0];\n        if (!file) return this.showErrorMessage(\"_undefined_shared_file\");\n        // do singles here\n        const reader = new FileReader();\n        if (/^application\\/(?:x-)?zip(?:-compressed)?$/.test(file.type)) {\n          reader.addEventListener(\"loadend\", this.zipLoadEndHandler);\n          reader.readAsArrayBuffer(file);\n        } else if (file.type === \"text/plain\") {\n          reader.addEventListener(\"loadend\", this.txtLoadEndHandler);\n          reader.readAsText(file);\n        } else {\n          this.showErrorMessage();\n        }\n      }\n    },\n\n    dragOver() {\n      this.isDragging = true;\n    },\n\n    dragLeave() {\n      this.isDragging = false;\n    },\n\n    drop(e) {\n      let fileList = e.dataTransfer.files;\n      this.processFileList(fileList);\n    },\n\n    requestUploadFile() {\n      let src = this.$el.querySelector(\"#uploadmytextfile\");\n      let fileList = src.files;\n      this.processFileList(fileList);\n    },\n  },\n};\n","import { render, staticRenderFns } from \"./FileHandler.vue?vue&type=template&id=f2c8d122&scoped=true&\"\nimport script from \"./FileHandler.vue?vue&type=script&lang=js&\"\nexport * from \"./FileHandler.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FileHandler.vue?vue&type=style&index=0&id=f2c8d122&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f2c8d122\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VIcon } from 'vuetify/lib/components/VIcon';\ninstallComponents(component, {VIcon})\n"],"sourceRoot":""}